

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>AviSynth Syntax - User defined script functions &#8212; AviSynth+ 3.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../../_static/AvsiDoc.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="AddBorders" href="../corefilters/addborders.html" />
    <link rel="prev" title="AviSynth Syntax" href="syntax_sections.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../corefilters/addborders.html" title="AddBorders"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="syntax_sections.html" title="AviSynth Syntax"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DocIcon-Large.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">AviSynth Syntax - User defined script functions</a><ul>
<li><a class="reference internal" href="#definition-and-structure">Definition and Structure</a></li>
<li><a class="reference internal" href="#facts-about-user-defined-script-functions">Facts about user defined script functions</a></li>
<li><a class="reference internal" href="#related-links">Related Links</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="syntax_sections.html"
                        title="previous chapter">AviSynth Syntax</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../corefilters/addborders.html"
                        title="next chapter">AddBorders</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/avisynthdoc/syntax/syntax_userdefined_scriptfunctions.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="avisynth-syntax-user-defined-script-functions">
<h1>AviSynth Syntax - User defined script functions<a class="headerlink" href="#avisynth-syntax-user-defined-script-functions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definition-and-structure">
<h2>Definition and Structure<a class="headerlink" href="#definition-and-structure" title="Permalink to this headline">¶</a></h2>
<p>You can define and call your own functions in AviSynth scripts as shown
below. The function can return any clip or variable type. An user defined
script function is an independent block of script code that is executed each
time a call to the function is made in the script. An example of a simple
user defined script function (here a custom filter) immediately follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">MuteRange</span><span class="p">(</span><span class="n">clip</span> <span class="n">c</span><span class="p">,</span> <span class="nb">int</span> <span class="n">fstart</span><span class="p">,</span> <span class="nb">int</span> <span class="n">fend</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">before</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">fstart</span><span class="p">)</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">fstart</span><span class="p">,</span> <span class="n">fend</span><span class="p">)</span>
    <span class="n">after</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">fend</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">audio</span> <span class="o">=</span> <span class="n">Dissolve</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">current</span><span class="o">.</span><span class="n">BlankClip</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">AudioDub</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">audio</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>User defined script functions start with the keyword <code class="docutils literal notranslate"><span class="pre">function</span></code> followed by
the function name. The name of a script function follows the same naming
rules as <a class="reference internal" href="syntax_script_variables.html"><span class="doc">script variables</span></a>.</p>
<p>Immediately after the name, the function’s argument list follows. The list
(which can be empty) consists of (expected argument’s type - argument’s name)
pairs. Each argument’s <a class="reference internal" href="syntax_script_variables.html"><span class="doc">type</span></a> may be any of those supported by the scripting
language.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">MuteRange</span><span class="p">(</span><span class="n">clip</span> <span class="n">c</span><span class="p">,</span> <span class="nb">int</span> <span class="n">fstart</span><span class="p">,</span> <span class="nb">int</span> <span class="n">fend</span><span class="p">)</span>
</pre></div>
</div>
<p>Then comes the function body, ie the code that is executed each time the
function is called. The arguments are accessed within the function body by
their names. The function body is contained within an opening and closing
brace pair <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">...</span> <span class="pre">}</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="n">before</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">fstart</span><span class="p">)</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">fstart</span><span class="p">,</span> <span class="n">fend</span><span class="p">)</span>
    <span class="n">after</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">fend</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">audio</span> <span class="o">=</span> <span class="n">Dissolve</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">current</span><span class="o">.</span><span class="n">BlankClip</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">AudioDub</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">audio</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>(For simplicity, this code assumes the function will only be called with
fstart &gt; 0 and fend &lt; c.Framecount-1. A more complete version would also
handle the special cases fstart=0 and fend=c.Framecount-1.)</p>
<p>At the end of the function body a <code class="docutils literal notranslate"><span class="pre">return</span></code> statement which returns the
final value calculated from the arguments and the function’s body code is
placed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="n">AudioDub</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">audio</span><span class="p">)</span>
</pre></div>
</div>
<p>It should be noted that unlike other languages where multiple return
statements are allowed inside the function body, in AviSynth functions
contain a <em>single</em> return statement. This is because the language does not
support branching (i.e. compound block statements).</p>
</div>
<div class="section" id="facts-about-user-defined-script-functions">
<h2>Facts about user defined script functions<a class="headerlink" href="#facts-about-user-defined-script-functions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Functions can take up to sixty arguments and the return value can be
of any type supported by the scripting language (clip, int, float, bool,
string).</li>
<li>Although not recommended practice, an argument type may be omitted,
and will default to <code class="docutils literal notranslate"><span class="pre">val</span></code>, the generic type.</li>
<li>If the function expects a video clip as its first argument, and that
argument is not supplied, then the clip in the special <code class="docutils literal notranslate"><span class="pre">last</span></code> variable
will be used.</li>
<li>Functions support <em>named arguments</em>. Simply enclose an argument’s
name inside double quotes to make it a named argument. Note that after
doing so the following apply:<ul>
<li><ol class="first arabic">
<li>All subsequent arguments in the argument list must be made named also.</li>
</ol>
</li>
<li><ol class="first arabic" start="2">
<li><strong>A named argument is an optional argument</strong>, that is, it need not be supplied by the caller.</li>
</ol>
</li>
<li><ol class="first arabic" start="3">
<li>When a function is called, any optional argument which has <em>not</em>
been provided is set to a value which has the void (‘undefined’) type.
This does not mean that its value is random garbage - simply that its
type is neither clip, int, float, bool or string and so it has <em>no</em>
usable value.</li>
</ol>
</li>
<li><ol class="first arabic" start="4">
<li>Normally, you should use the <a class="reference internal" href="syntax_internal_functions_boolean.html"><span class="doc">Defined</span></a> function to test if an
optional argument has an explicit value, or the <a class="reference internal" href="syntax_internal_functions_control.html"><span class="doc">Default</span></a> function,
which combines the Defined test with the delivery of a default value if
appropriate.</li>
</ol>
</li>
<li><ol class="first arabic" start="5">
<li>A void (‘undefined’) value can be passed on to another function
as one of its optional arguments. This is useful when you want to write a
wrapper function that calls another function, preserving the same
defaults.</li>
</ol>
</li>
</ul>
</li>
<li>Functions always produce a new value and never modify an existing
one. What that means is that all arguments to a function are passed “by
value” and not “by reference”; in order to alter a variable’s value in
AviSynth script language you must assign to it a new value.</li>
<li>Functions can call other functions, <em>including theirselves</em>. The
latter is known as recursion and is a very useful technique for creating
functions that can accomplish complex tasks.</li>
<li>Local function variables mask global ones with the same name inside
the function body. For example, if you define in a function a local
variable <code class="docutils literal notranslate"><span class="pre">myvar</span></code> by assigning to it a value, then you cannot read the
global <code class="docutils literal notranslate"><span class="pre">myvar</span></code> anymore inside this function.</li>
<li>The above is also true for arguments, since from the perspective of a
function arguments are initialized local variables.</li>
<li>Each function has its own local version of the special variable
<em>last</em>. On entry to a function, <em>last</em> is set to a void (‘undefined’)
value.</li>
</ul>
</div>
<div class="section" id="related-links">
<h2>Related Links<a class="headerlink" href="#related-links" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://avisynth.org/mediawiki/Shared_functions">Shared functions</a>. An ever growing collection of shared script
functions created by the members of the AviSynth community.</li>
</ul>
<p>{TEMP: <a class="reference external" href="http://www.avisynth.org/ShareFunctions">http://www.avisynth.org/ShareFunctions</a>}</p>
<ul class="simple">
<li><a class="reference external" href="http://avisynth.org/mediawiki/index.php?title=Shared_functions/Conditional&amp;action=edit">Conditional filters and script functions</a>. A collection of highly
useful conditional filters implemented as user defined script functions.</li>
</ul>
<div class="line-block">
<div class="line">{TEMP:</div>
<div class="line"><a class="reference external" href="http://www.avisynth.org/ExportingSingleImage">http://www.avisynth.org/ExportingSingleImage</a>,</div>
<div class="line"><a class="reference external" href="http://www.avisynth.org/HowToApplyFilterToManySingleFrames">http://www.avisynth.org/HowToApplyFilterToManySingleFrames</a>,</div>
<div class="line">Perhaps make decent functions from the last two?}</div>
</div>
<p>$Date: 2013/03/19 18:10:27 $</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../corefilters/addborders.html" title="AddBorders"
             >next</a> |</li>
        <li class="right" >
          <a href="syntax_sections.html" title="AviSynth Syntax"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2000-2019, AviSynth and AviSynth+ contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>