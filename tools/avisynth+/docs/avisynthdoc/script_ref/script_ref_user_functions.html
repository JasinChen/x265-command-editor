

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>User functions &#8212; AviSynth+ 3.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../../_static/AvsiDoc.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Getting started" href="../syntax/syntax.html" />
    <link rel="prev" title="The script execution model - Sequence of events" href="script_ref_execution_model_sequence_events.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../syntax/syntax.html" title="Getting started"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="script_ref_execution_model_sequence_events.html" title="The script execution model - Sequence of events"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DocIcon-Large.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">User functions</a><ul>
<li><a class="reference internal" href="#the-function-declaration-header">The function declaration (header)</a><ul>
<li><a class="reference internal" href="#the-function-name">The function name</a></li>
<li><a class="reference internal" href="#the-argument-list">The argument list</a><ul>
<li><a class="reference internal" href="#typed-and-variable-val-arguments">Typed and variable (<code class="docutils literal notranslate"><span class="pre">val</span></code>) arguments</a></li>
<li><a class="reference internal" href="#required-and-optional-arguments">Required and optional arguments</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-function-body">The function body</a><ul>
<li><a class="reference internal" href="#argument-validation-and-setup-of-local-variables">Argument validation and setup of local variables</a></li>
<li><a class="reference internal" href="#performance-of-intermediate-computations">Performance of intermediate computations</a></li>
<li><a class="reference internal" href="#return-of-final-computation-outcome-to-the-caller">Return of final computation outcome to the caller</a></li>
</ul>
</li>
<li><a class="reference internal" href="#designing-and-developing-user-functions">Designing and developing user functions</a><ul>
<li><a class="reference internal" href="#defining-goals">Defining goals</a></li>
<li><a class="reference internal" href="#manipulating-globals">Manipulating globals</a></li>
<li><a class="reference internal" href="#recursion">Recursion</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tuning-performance">Tuning performance</a></li>
<li><a class="reference internal" href="#design-and-coding-style-considerations">Design and coding-style considerations</a></li>
<li><a class="reference internal" href="#organising-user-defined-functions">Organising user defined functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="script_ref_execution_model_sequence_events.html"
                        title="previous chapter">The script execution model - Sequence of events</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../syntax/syntax.html"
                        title="next chapter">Getting started</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/avisynthdoc/script_ref/script_ref_user_functions.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="user-functions">
<h1><a class="toc-backref" href="#id1">User functions</a><a class="headerlink" href="#user-functions" title="Permalink to this headline">¶</a></h1>
<p>Having read the basics about <a class="reference internal" href="../syntax/syntax_userdefined_scriptfunctions.html"><span class="doc">user-defined script functions</span></a>, we can now
step forward to examine in detail each function building block and identify
rules for effective code development.</p>
<div class="toctree-wrapper compound">
</div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#user-functions" id="id1">User functions</a><ul>
<li><a class="reference internal" href="#the-function-declaration-header" id="id2">The function declaration (header)</a><ul>
<li><a class="reference internal" href="#the-function-name" id="id3">The function name</a></li>
<li><a class="reference internal" href="#the-argument-list" id="id4">The argument list</a><ul>
<li><a class="reference internal" href="#typed-and-variable-val-arguments" id="id5">Typed and variable (<code class="docutils literal notranslate"><span class="pre">val</span></code>) arguments</a></li>
<li><a class="reference internal" href="#required-and-optional-arguments" id="id6">Required and optional arguments</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-function-body" id="id7">The function body</a><ul>
<li><a class="reference internal" href="#argument-validation-and-setup-of-local-variables" id="id8">Argument validation and setup of local variables</a></li>
<li><a class="reference internal" href="#performance-of-intermediate-computations" id="id9">Performance of intermediate computations</a></li>
<li><a class="reference internal" href="#return-of-final-computation-outcome-to-the-caller" id="id10">Return of final computation outcome to the caller</a></li>
</ul>
</li>
<li><a class="reference internal" href="#designing-and-developing-user-functions" id="id11">Designing and developing user functions</a><ul>
<li><a class="reference internal" href="#defining-goals" id="id12">Defining goals</a></li>
<li><a class="reference internal" href="#manipulating-globals" id="id13">Manipulating globals</a></li>
<li><a class="reference internal" href="#recursion" id="id14">Recursion</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tuning-performance" id="id15">Tuning performance</a></li>
<li><a class="reference internal" href="#design-and-coding-style-considerations" id="id16">Design and coding-style considerations</a></li>
<li><a class="reference internal" href="#organising-user-defined-functions" id="id17">Organising user defined functions</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="the-function-declaration-header">
<h2><a class="toc-backref" href="#id2">The function declaration (header)</a><a class="headerlink" href="#the-function-declaration-header" title="Permalink to this headline">¶</a></h2>
<p>The function declaration consists of the keyword <code class="docutils literal notranslate"><span class="pre">function</span></code> followed by the
function’s name and a (possibly empty) list of parameters (arguments)
enclosed in a pair of parentheses. Its purpose is to declare the function,
that is both make its name visible to the running script and state the number
and type of the arguments that it expects in subsequent invocations (function
calls).</p>
<p>Note that in AviSynth script language the declaration is also a definition;
the function body (the code that is executed every time the function is
called) must be supplied immediately after.</p>
<div class="section" id="the-function-name">
<h3><a class="toc-backref" href="#id3">The function name</a><a class="headerlink" href="#the-function-name" title="Permalink to this headline">¶</a></h3>
<p>To name your user function you can pick any name that appropriately describes
the purpose of it. You should however avoid naming a function with an already
widely used name; the AviSynth script language namespace is flat and thus any
such name collision means you (and others) cannot use both functions
together. Note also that function names (as everything in AviSynth script
language) are case insensitive.</p>
</div>
<div class="section" id="the-argument-list">
<h3><a class="toc-backref" href="#id4">The argument list</a><a class="headerlink" href="#the-argument-list" title="Permalink to this headline">¶</a></h3>
<p>Regarding the possible different kinds of arguments a function can declare,
there are two orthogonal to each other categorical divisions:</p>
<ol class="arabic simple">
<li><strong>Typed</strong> vs <strong>variable</strong> arguments.</li>
<li><strong>Required</strong> vs <strong>optional</strong> arguments.</li>
</ol>
<div class="section" id="typed-and-variable-val-arguments">
<h4><a class="toc-backref" href="#id5">Typed and variable (<code class="docutils literal notranslate"><span class="pre">val</span></code>) arguments</a><a class="headerlink" href="#typed-and-variable-val-arguments" title="Permalink to this headline">¶</a></h4>
<p>Typed arguments have a fixed type, decided by the specific type prefix (clip,
int, float, bool, string) used during function declaration. Whenever a script
is calling a function, AviSynth checks the supplied values for all typed
arguments to ensure that they are of the proper type; if a discrepancy is
found an error condition is triggered. Therefore, typed arguments can always
be assumed of being the correct type (but not ‘value’!) inside the body of
the function, simplifying coding.</p>
<p>Variable arguments can accept <em>any</em> AviSynth type (clip, int, float, bool,
string) when the function is called. You can declare a function argument as
being variable with either of two ways:</p>
<ul class="simple">
<li>specify <code class="docutils literal notranslate"><span class="pre">val</span></code> as the type of the argument, for example:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">myfunc</span><span class="p">(</span><span class="n">clip</span> <span class="n">c</span><span class="p">,</span> <span class="n">val</span> <span class="n">effect</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="n">function</span> <span class="n">myfunc2</span><span class="p">(</span><span class="n">clip</span> <span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">val</span> <span class="s2">&quot;action&quot;</span><span class="o">**</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>do <em>not</em> specify a type for the argument, for example:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">myfunc</span><span class="p">(</span><span class="n">clip</span> <span class="n">c</span><span class="p">,</span> <span class="n">effect</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="n">function</span> <span class="n">myfunc2</span><span class="p">(</span><span class="n">clip</span> <span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="s2">&quot;action&quot;</span><span class="o">**</span><span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>As a side effect, whenever you neglet to provide the type of an argument you
will get a variable argument. Keep this in mind when you are debugging your
scripts.</p>
<p>Variable arguments can also be optional. To do so, you simply enclose the
argument in double quotes, as for typed arguments.</p>
<p>Variable arguments are useful in some situations because they provide
flexibility and reduce the size of the argument list. However, they have the
drawback that your function code has to check the type of each variable
argument in order to ensure its validity for the intended operation (for
typed arguments, the type check is performed by AviSynth).</p>
</div>
<div class="section" id="required-and-optional-arguments">
<h4><a class="toc-backref" href="#id6">Required and optional arguments</a><a class="headerlink" href="#required-and-optional-arguments" title="Permalink to this headline">¶</a></h4>
<p>Required arguments must always be supplied when you are calling the function</p>
<p>Optional arguments need not be supplied; they default (if the function is
coded correctly) to reasonable initial values.</p>
</div>
</div>
</div>
<div class="section" id="the-function-body">
<h2><a class="toc-backref" href="#id7">The function body</a><a class="headerlink" href="#the-function-body" title="Permalink to this headline">¶</a></h2>
<p>The function body contains the bulk of the code that makes up your function.
Since they strongly depend on the tasks-on-hand, the contents of the function
body are quite arbitrary. However, there are some frequently occuring coding
patterns that together form a more or less “standard” recipe for constructing
the function body. These are in the usual order of appearance the following:</p>
<ul class="simple">
<li>Argument validation and setup of local variables.</li>
<li>Performance of intermediate computations.</li>
<li>Return of final computation outcome to the caller of the function.</li>
</ul>
<p>We will now look closer on each one in the paragraphs that follow.</p>
<div class="section" id="argument-validation-and-setup-of-local-variables">
<h3><a class="toc-backref" href="#id8">Argument validation and setup of local variables</a><a class="headerlink" href="#argument-validation-and-setup-of-local-variables" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="performance-of-intermediate-computations">
<h3><a class="toc-backref" href="#id9">Performance of intermediate computations</a><a class="headerlink" href="#performance-of-intermediate-computations" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="return-of-final-computation-outcome-to-the-caller">
<h3><a class="toc-backref" href="#id10">Return of final computation outcome to the caller</a><a class="headerlink" href="#return-of-final-computation-outcome-to-the-caller" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="designing-and-developing-user-functions">
<h2><a class="toc-backref" href="#id11">Designing and developing user functions</a><a class="headerlink" href="#designing-and-developing-user-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="defining-goals">
<h3><a class="toc-backref" href="#id12">Defining goals</a><a class="headerlink" href="#defining-goals" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="manipulating-globals">
<h3><a class="toc-backref" href="#id13">Manipulating globals</a><a class="headerlink" href="#manipulating-globals" title="Permalink to this headline">¶</a></h3>
<p>how to use effectively and safely</p>
</div>
<div class="section" id="recursion">
<h3><a class="toc-backref" href="#id14">Recursion</a><a class="headerlink" href="#recursion" title="Permalink to this headline">¶</a></h3>
<p>the only tool to act upon collections</p>
</div>
</div>
<div class="section" id="tuning-performance">
<h2><a class="toc-backref" href="#id15">Tuning performance</a><a class="headerlink" href="#tuning-performance" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="design-and-coding-style-considerations">
<h2><a class="toc-backref" href="#id16">Design and coding-style considerations</a><a class="headerlink" href="#design-and-coding-style-considerations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="organising-user-defined-functions">
<h2><a class="toc-backref" href="#id17">Organising user defined functions</a><a class="headerlink" href="#organising-user-defined-functions" title="Permalink to this headline">¶</a></h2>
<p>Back to <a class="reference internal" href="script_ref.html"><span class="doc">scripting reference</span></a>.</p>
<p>$Date: 2011/04/29 20:36:18 $</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../syntax/syntax.html" title="Getting started"
             >next</a> |</li>
        <li class="right" >
          <a href="script_ref_execution_model_sequence_events.html" title="The script execution model - Sequence of events"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2000-2019, AviSynth and AviSynth+ contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>