

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>AviSynth FilterSDK &#8212; AviSynth+ 3.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../../_static/AvsiDoc.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Compiling AviSynth+" href="../contributing/compiling_avsplus.html" />
    <link rel="prev" title="Overview" href="../overview.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../contributing/compiling_avsplus.html" title="Compiling AviSynth+"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../overview.html" title="Overview"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DocIcon-Large.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">AviSynth FilterSDK</a><ul>
<li><a class="reference internal" href="#necessary-software">Necessary software</a></li>
<li><a class="reference internal" href="#writing-a-plugin">Writing a plugin</a><ul>
<li><a class="reference internal" href="#processing-video">Processing video</a></li>
<li><a class="reference internal" href="#processing-audio">Processing audio</a></li>
<li><a class="reference internal" href="#runtime-functions">Runtime functions</a></li>
<li><a class="reference internal" href="#source-filters">Source filters</a></li>
<li><a class="reference internal" href="#speeding-up-your-plugin-using-assembler">Speeding up your plugin using assembler</a></li>
<li><a class="reference internal" href="#making-dual-plugins">Making dual plugins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-console-applications-that-access-avisynth">Writing console applications that access AviSynth</a></li>
<li><a class="reference internal" href="#compiling-plugins-and-console-applications-that-access-avisynth">Compiling plugins and console applications that access AviSynth</a></li>
<li><a class="reference internal" href="#debugging-plugins-and-console-applications-that-access-avisynth">Debugging plugins and console applications that access AviSynth</a></li>
<li><a class="reference internal" href="#avisynth-and-its-plugin-api-s">AviSynth and its plugin api’s</a></li>
<li><a class="reference internal" href="#what-s-new-in-the-2-6-api">What’s new in the 2.6 api</a></li>
<li><a class="reference internal" href="#some-history">Some history</a></li>
<li><a class="reference internal" href="#other-sources">Other sources ???</a></li>
<li><a class="reference internal" href="#license-terms">License terms</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../overview.html"
                        title="previous chapter">Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../contributing/compiling_avsplus.html"
                        title="next chapter">Compiling AviSynth+</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/avisynthdoc/FilterSDK/FilterSDK.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="avisynth-filtersdk">
<h1><a class="toc-backref" href="#id4">AviSynth FilterSDK</a><a class="headerlink" href="#avisynth-filtersdk" title="Permalink to this headline">¶</a></h1>
<p>AviSynth external Filter SDK is a package for developers to create your own
filters (plugins and console applications) for AviSynth.</p>
<p>The package consists of:</p>
<ul class="simple">
<li>these documentation text files (in HTML or Wiki format);</li>
<li>the header file ‘avisynth.h’ (recent version) with all declarations
to include in plugin source code;</li>
<li>several plugin and console application source codes;</li>
<li>some extra files in ‘Extra’ folder.</li>
</ul>
<div class="toctree-wrapper compound">
</div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#avisynth-filtersdk" id="id4">AviSynth FilterSDK</a><ul>
<li><a class="reference internal" href="#necessary-software" id="id5">Necessary software</a></li>
<li><a class="reference internal" href="#writing-a-plugin" id="id6">Writing a plugin</a><ul>
<li><a class="reference internal" href="#processing-video" id="id7">Processing video</a></li>
<li><a class="reference internal" href="#processing-audio" id="id8">Processing audio</a></li>
<li><a class="reference internal" href="#runtime-functions" id="id9">Runtime functions</a></li>
<li><a class="reference internal" href="#source-filters" id="id10">Source filters</a></li>
<li><a class="reference internal" href="#speeding-up-your-plugin-using-assembler" id="id11">Speeding up your plugin using assembler</a></li>
<li><a class="reference internal" href="#making-dual-plugins" id="id12">Making dual plugins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-console-applications-that-access-avisynth" id="id13">Writing console applications that access AviSynth</a></li>
<li><a class="reference internal" href="#compiling-plugins-and-console-applications-that-access-avisynth" id="id14">Compiling plugins and console applications that access AviSynth</a></li>
<li><a class="reference internal" href="#debugging-plugins-and-console-applications-that-access-avisynth" id="id15">Debugging plugins and console applications that access AviSynth</a></li>
<li><a class="reference internal" href="#avisynth-and-its-plugin-api-s" id="id16">AviSynth and its plugin api’s</a></li>
<li><a class="reference internal" href="#what-s-new-in-the-2-6-api" id="id17">What’s new in the 2.6 api</a></li>
<li><a class="reference internal" href="#some-history" id="id18">Some history</a></li>
<li><a class="reference internal" href="#other-sources" id="id19">Other sources ???</a></li>
<li><a class="reference internal" href="#license-terms" id="id20">License terms</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="necessary-software">
<h2><a class="toc-backref" href="#id5">Necessary software</a><a class="headerlink" href="#necessary-software" title="Permalink to this headline">¶</a></h2>
<p>You must have some <a class="reference internal" href="SDKNecessaries.html"><span class="doc">necessary software.</span></a></p>
</div>
<div class="section" id="writing-a-plugin">
<h2><a class="toc-backref" href="#id6">Writing a plugin</a><a class="headerlink" href="#writing-a-plugin" title="Permalink to this headline">¶</a></h2>
<p>We will start by writing some simple plugins to show you the basics.</p>
<div class="section" id="processing-video">
<h3><a class="toc-backref" href="#id7">Processing video</a><a class="headerlink" href="#processing-video" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="InvertNeg.html"><span class="doc">InvertNeg</span></a> produces a photo-negative of the input clip.</li>
<li><a class="reference internal" href="SimpleSample.html"><span class="doc">SimpleSample</span></a> has some very simple examples covering development
of a filter that draws a variable sized square, in the middle of
the screen. It does so for all color formats.</li>
</ul>
<p>One thing not covered in SimpleSample, is how to <a class="reference internal" href="ChangeFrameSize.html"><span class="doc">change frame size</span></a> in a
filter.</p>
</div>
<div class="section" id="processing-audio">
<h3><a class="toc-backref" href="#id8">Processing audio</a><a class="headerlink" href="#processing-audio" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>xxx</li>
</ul>
<p>Also have a look at <a class="reference internal" href="GettingStartedWithAudio.html"><span class="doc">Getting started with Audio</span></a>.</p>
</div>
<div class="section" id="runtime-functions">
<h3><a class="toc-backref" href="#id9">Runtime functions</a><a class="headerlink" href="#runtime-functions" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="Non-ClipSample.html"><span class="doc">Non-clip sample</span></a> how to create runtime AviSynth functions.</p>
</div>
<div class="section" id="source-filters">
<h3><a class="toc-backref" href="#id10">Source filters</a><a class="headerlink" href="#source-filters" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference internal" href="GradientMask.html"><span class="doc">GradientMask</span></a> creates a simple Gradient. The example explains a
few things how source filters work.</li>
</ul>
</div>
<div class="section" id="speeding-up-your-plugin-using-assembler">
<h3><a class="toc-backref" href="#id11">Speeding up your plugin using assembler</a><a class="headerlink" href="#speeding-up-your-plugin-using-assembler" title="Permalink to this headline">¶</a></h3>
<p>You can also browse various topic on <a class="reference internal" href="AssemblerOptimizing.html"><span class="doc">Assembler Optimizing</span></a>.</p>
</div>
<div class="section" id="making-dual-plugins">
<h3><a class="toc-backref" href="#id12">Making dual plugins</a><a class="headerlink" href="#making-dual-plugins" title="Permalink to this headline">¶</a></h3>
<p>One of the features of AviSynth 2.6 is that 2.5 plugins (plugins
compiled with plugin api v3) can still be used in AviSynth 2.6,
although you need to make sure you use it properly since it doesn’t
know about the new features in AviSynth 2.6. So when processing a clip
(with say color format YV16) with a 2.5 plugin you will get a messed up
clip at best, and a crash at worst, since YV16 is not supported in the
v3 api.</p>
<p>There are several ways to make 2.6 plugins (plugins compiled with
plugin api v5 or higher) also work with AviSynth 2.5. They are
described <a class="reference internal" href="DualPlugins.html"><span class="doc">here</span></a>.</p>
</div>
</div>
<div class="section" id="writing-console-applications-that-access-avisynth">
<h2><a class="toc-backref" href="#id13">Writing console applications that access AviSynth</a><a class="headerlink" href="#writing-console-applications-that-access-avisynth" title="Permalink to this headline">¶</a></h2>
<p>When writing console applications (commandline programs) it is possible
to access AviSynth in two ways.</p>
<p>The first one is to use the VfW api (using the <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd756808(v=vs.85).aspx">AVIFile library</a>)
like is done in avs2avi (see <a class="reference external" href="http://forum.doom9.org/showthread.php?t=71493">[1]</a> or <a class="reference external" href="http://www.avisynth.info/?%E3%82%A2%E3%83%BC%E3%82%AB%E3%82%A4%E3%83%96#t952b3b1">[2]</a>), avs2yuv (<a class="reference external" href="http://komisar.gin.by/tools/avs2yuv/avs2yuv-0.24bm2.zip">using
the C api</a>, or <a class="reference external" href="http://kemuri9.net/dev/avs/avs2yuv/avs2yuv.zip">using the C++ api</a>), or <a class="reference external" href="http://forum.doom9.org/showthread.php?p=1502613#post1502613">avs2wav</a> for example. See
also <a class="reference external" href="http://forum.doom9.org/showthread.php?p=589781#post589781">here</a> to get you going.</p>
<p>The second one is to call AviSynth directly like is done in
<a class="reference external" href="http://forum.doom9.org/showthread.php?t=160383">avs2pipe</a> for example (it uses the C api). It’s a tool to output y4m
video or wav audio to stdout. The way to do this is importing
avisynth.dll via loadlibrary() and getprocaddress(). Then creating a
scriptenvironment and importing a script using invoke(). At that point
you will have a clip from which you can call getframe() to access the
video and getaudio() to access the audio.</p>
<p>Below are some examples that have a script as input and raw video or
audio as output:</p>
<ul class="simple">
<li><a class="reference internal" href="avs2yuv.html"><span class="doc">avs2yuv</span></a> reads a script and outputs raw video.</li>
<li><a class="reference internal" href="avs2pcm.html"><span class="doc">avs2pcm</span></a> reads a script and outputs raw audio.</li>
</ul>
</div>
<div class="section" id="compiling-plugins-and-console-applications-that-access-avisynth">
<h2><a class="toc-backref" href="#id14">Compiling plugins and console applications that access AviSynth</a><a class="headerlink" href="#compiling-plugins-and-console-applications-that-access-avisynth" title="Permalink to this headline">¶</a></h2>
<p>How to compile plugins and console applications that access AviSynth is
described <a class="reference internal" href="CompilingAvisynthPlugins.html"><span class="doc">here</span></a>.</p>
</div>
<div class="section" id="debugging-plugins-and-console-applications-that-access-avisynth">
<h2><a class="toc-backref" href="#id15">Debugging plugins and console applications that access AviSynth</a><a class="headerlink" href="#debugging-plugins-and-console-applications-that-access-avisynth" title="Permalink to this headline">¶</a></h2>
<p>How to debug plugins and console applications that access AviSynth is
described <a class="reference internal" href="DebuggingAvisynthPlugins.html"><span class="doc">here</span></a>.</p>
</div>
<div class="section" id="avisynth-and-its-plugin-api-s">
<h2><a class="toc-backref" href="#id16">AviSynth and its plugin api’s</a><a class="headerlink" href="#avisynth-and-its-plugin-api-s" title="Permalink to this headline">¶</a></h2>
<p>AviSynth exists as an instance of the ScriptEnvironment class, that
implements the IScriptEnvironment interface. The IScriptEnvironment
interface is defined in avisynth.h (and avisynth_c.h) and it is the
only way for plugins and external applications to communicate with
AviSynth. A pointer to ScriptEnvironment object is passed along to all
plugins, so that they can use AviSynth facilities. Plugins are
forbidden from storing this pointer. AviSynth creates one
ScriptEnvironment object when Windows attempts to use AviSynth to open
a script via AVIFile API.</p>
<p>When ScriptEnvironment is created, it checks for CPU extensions (to
provide this information to filters that are able to use CPU
extensions), sets up memory limits for itself and performs pre-scanning
of all plugins.</p>
<p>AviSynth has the capability to load third-party libraries that include
their own video and audio filters. It comes with two language
interfaces (or plugin api’s):</p>
<ul class="simple">
<li>C++ API (through avisynth.h) - The classes and miscellaneous
constants are described in <a class="reference internal" href="Cplusplus_api.html"><span class="doc">here</span></a>.</li>
<li>C API (through avisynth_c.h) - The classes and miscellaneous
constants are described in <a class="reference internal" href="C_api.html"><span class="doc">here</span></a>.</li>
</ul>
<p>The built-in filters use the C++ API. This Filter SDK (or Source
Development Kit) describes how to create plugins using both interfaces.</p>
<p>Although not included in AviSynth itself, several people wrote other
language interfaces in Delphi, Purebasic, NET and Java. They can be
found <a class="reference external" href="http://forum.doom9.org/showthread.php?p=566904#post566904">here</a>.</p>
<p>…</p>
<p>There are several different Colorspaces in AviSynth. See more information
about <a class="reference internal" href="ColorSpaces.html"><span class="doc">Color Spaces</span></a> and <a class="reference internal" href="WorkingWithImages.html"><span class="doc">Working With Images</span></a>.</p>
</div>
<div class="section" id="what-s-new-in-the-2-6-api">
<h2><a class="toc-backref" href="#id17">What’s new in the 2.6 api</a><a class="headerlink" href="#what-s-new-in-the-2-6-api" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">C++ API (AVISYNTH_INTERFACE_VERSION = 6):</p>
<blockquote>
<div><ul>
<li><p class="first">Plugin api v3 and older contained <a class="reference internal" href="AVSLinkage.html"><span class="doc">baked code</span></a> meaning code
that is “baked” into all and every plugin instead being called
from avisynth.dll. Starting from 2.6 the version 2.5 plugins
are supported directly (with current baked code; meaning that
plugins compiled for 2.5 can be loaded when using 2.6) and all
the baked code from 2.6+ plugins is removed and the plugins
are still source compatible. Note that the baked code is moved
to interface.cpp, where also the structure <a class="reference internal" href="AVSLinkage.html"><span class="doc">AVS_Linkage</span></a> is
defined.</p>
</li>
<li><p class="first">The <a class="reference internal" href="Cplusplus_api.html#cplusplus-iscriptenvironment"><span class="std std-ref">IScriptEnvironment</span></a> interface has several new members:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="Cplusplus_api.html#cplusplus-applymessage"><span class="std std-ref">ApplyMessage</span></a> writes text on a frame.</li>
<li><a class="reference internal" href="Cplusplus_api.html#cplusplus-deletescriptenvironment"><span class="std std-ref">DeleteScriptEnvironment</span></a> provides a method to delete
the ScriptEnvironment which is created with
CreateScriptEnvironment.</li>
<li><a class="reference internal" href="Cplusplus_api.html#cplusplus-getavslinkage"><span class="std std-ref">GetAVSLinkage</span></a> returns the AVSLinkage.</li>
<li><a class="reference internal" href="Cplusplus_api.html#cplusplus-getvardef"><span class="std std-ref">GetVarDef</span></a> can be used to access AviSynth variables.
It will not throw an error if the variable doesn’t exist.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">It uses size_t for things that are memory sizes, ready for 64 bit port.</p>
</li>
<li><p class="first">New colorformats are added: Y8, YV411, YV16 and YV24.</p>
</li>
<li><p class="first"><a class="reference internal" href="VideoInfo.html"><span class="doc">VideoInfo</span></a> has several new constants and functions (the
ones relating to the new colorformats, the chroma placement
constants, GetPlaneHeightSubsampling,
GetPlaneWidthSubsampling).</p>
</li>
<li><p class="first">Some new cache and cpu constants for GetCPUFlags (the v5/v6 ones).</p>
</li>
<li><p class="first">SetCacheHints changed from void to int.</p>
</li>
</ul>
</div></blockquote>
</li>
<li><dl class="first docutils">
<dt>C API (AVISYNTH_INTERFACE_VERSION = 6):</dt>
<dd><ul class="first last simple">
<li>The following functions are added to the interface:
avs_is_yv24, avs_is_yv16, avs_is_yv12, avs_is_yv411,
avs_is_y8, avs_is_color_space,
avs_get_plane_width_subsampling,
avs_get_plane_height_subsampling, avs_bits_per_pixel,
avs_bytes_from_pixels, avs_row_size, avs_bmp_size,
avs_get_row_size_p, avs_get_height_p and
avs_delete_script_environment.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="some-history">
<h2><a class="toc-backref" href="#id18">Some history</a><a class="headerlink" href="#some-history" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="BensAviSynthDocs.html"><span class="doc">Ben’s AviSynth Docs</span></a> is the documentation written for AviSynth 1.0
by Ben Rudiak-Gould, in its original form.</p>
<p>See more about the modifications for AviSynth 2.5 in the <a class="reference internal" href="AviSynthTwoFiveSDK.html"><span class="doc">AviSynth Two-Five SDK</span></a>.</p>
<p>Please read AviSynth <a class="reference internal" href="SDKHistory.html"><span class="doc">SDK History</span></a>. —</p>
</div>
<div class="section" id="other-sources">
<h2><a class="toc-backref" href="#id19">Other sources ???</a><a class="headerlink" href="#other-sources" title="Permalink to this headline">¶</a></h2>
<p>Once you’ve got the basics down on AVS development (Ben’s text is quite
good), the <a class="reference external" href="http://virtualdub.org/filtersdk">[SDK]</a> for VirtualDub is also a good read. Good news is you
won’t have to worry about writing <a class="reference external" href="http://function-pointer.org/">[function pointers]</a> and <a class="reference external" href="http://www.charlespetzold.com/pw5/index.html">[raw Win32]</a>;
meanwhile, Avery knows his stuff when it comes to video &amp; CPU optimization
techniques, so you better pay attention.</p>
<p>Some video related ebooks (PDF) can be downloaded freely from <a class="reference external" href="http://www.snellwilcox.com/reference.html">[Snell &amp; Wilcox]</a>. edit -
<a class="reference external" href="http://www.snellgroup.com/support/documentation/engineering-guides">this</a>???</p>
</div>
<div class="section" id="license-terms">
<h2><a class="toc-backref" href="#id20">License terms</a><a class="headerlink" href="#license-terms" title="Permalink to this headline">¶</a></h2>
<p>Note: Avisynth Filter SDK parts are under specific <a class="reference internal" href="SDKLicense.html"><span class="doc">SDK license</span></a> terms.</p>
<p>$Date: 2015/09/14 20:23:59 $</p>
<p>Latest online mediaWiki version is at <a class="reference external" href="http://avisynth.nl/Filter_SDK">http://avisynth.nl/Filter_SDK</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../contributing/compiling_avsplus.html" title="Compiling AviSynth+"
             >next</a> |</li>
        <li class="right" >
          <a href="../overview.html" title="Overview"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2000-2019, AviSynth and AviSynth+ contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>