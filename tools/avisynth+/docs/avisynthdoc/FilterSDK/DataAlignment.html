

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DataAlignment &#8212; AviSynth+ 3.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../../_static/AvsiDoc.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DataStorageInAviSynth" href="DataStorageInAviSynth.html" />
    <link rel="prev" title="C++ API" href="Cplusplus_api.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="DataStorageInAviSynth.html" title="DataStorageInAviSynth"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Cplusplus_api.html" title="C++ API"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DocIcon-Large.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">DataAlignment</a><ul>
<li><a class="reference internal" href="#memory-alignment">Memory alignment</a></li>
<li><a class="reference internal" href="#store-to-load-forwarding">Store to Load Forwarding</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Cplusplus_api.html"
                        title="previous chapter">C++ API</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="DataStorageInAviSynth.html"
                        title="next chapter">DataStorageInAviSynth</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/avisynthdoc/FilterSDK/DataAlignment.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dataalignment">
<h1><a class="reference external" href="http://www.avisynth.org/DataAlignment">DataAlignment</a><a class="headerlink" href="#dataalignment" title="Permalink to this headline">¶</a></h1>
<p>(Until something more AviSynth related can be written this is from the
<a class="reference internal" href="AMDOptimizationGuide.html"><span class="doc">AMDOptimizationGuide</span></a>)</p>
<div class="section" id="memory-alignment">
<h2>Memory alignment<a class="headerlink" href="#memory-alignment" title="Permalink to this headline">¶</a></h2>
<p>In general, avoid misaligned data references. All data whose size is a power
of two is considered aligned if it is naturally aligned.</p>
<p>For example:</p>
<ul class="simple">
<li>Word accesses are aligned if they access an address divisible by two.</li>
<li>Doubleword accesses are aligned if they access an address divisible
by four.</li>
<li>Quadword accesses are aligned if they access an address divisible by
eight.</li>
<li>TBYTE accesses are aligned if they access an address divisible by
eight.</li>
</ul>
<p>In AviSynth each frame is most of the time aligned to an address divideable
by 16. The exception for this rule is when crop() has been used. Furthermore
each line is also most of the time aligned to an address divideable by 16 (or
8 for planar chroma).</p>
</div>
<div class="section" id="store-to-load-forwarding">
<h2>Store to Load Forwarding<a class="headerlink" href="#store-to-load-forwarding" title="Permalink to this headline">¶</a></h2>
<p>Whenever some data is written to memory it is put in the cache. It is however
possible for the processor to access this data quite fast after it has been
written. This is called Store To Load forwarding.</p>
<p>Avoid memory-size mismatches when different instructions operate on the same
data. When an instruction stores and another instruction reloads the same
data, keep their operands aligned and keep the loads/stores of each operand
the same size.</p>
<p>The following code examples result in a store-to-loadforwarding (STLF) stall:</p>
<p><strong>Example (avoid):</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">MOV</span> <span class="pre">[FOO],</span> <span class="pre">EAX</span></code> <code class="docutils literal notranslate"><span class="pre">MOV</span> <span class="pre">[FOO+4],</span> <span class="pre">EDX</span></code> <code class="docutils literal notranslate"><span class="pre">...</span></code> <code class="docutils literal notranslate"><span class="pre">MOVQ</span> <span class="pre">MM0,</span> <span class="pre">[FOO]</span></code></p>
<p><strong>Example (preferred):</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">MOV</span> <span class="pre">[FOO],</span> <span class="pre">EAX</span></code> <code class="docutils literal notranslate"><span class="pre">MOV</span> <span class="pre">[FOO+4],</span> <span class="pre">EDX</span></code> <code class="docutils literal notranslate"><span class="pre">...</span></code> <code class="docutils literal notranslate"><span class="pre">MOVD</span> <span class="pre">MM0,</span> <span class="pre">[FOO]</span></code>
<code class="docutils literal notranslate"><span class="pre">PUNPCKLDQ</span> <span class="pre">MM0,</span> <span class="pre">[FOO+4]</span></code></p>
<p><strong>Example (avoid):</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">MOVQ</span> <span class="pre">[foo],</span> <span class="pre">MM0</span></code> <code class="docutils literal notranslate"><span class="pre">...</span></code> <code class="docutils literal notranslate"><span class="pre">MOV</span> <span class="pre">EAX,</span> <span class="pre">[foo]</span></code> <code class="docutils literal notranslate"><span class="pre">MOV</span> <span class="pre">EDX,</span> <span class="pre">[foo+4]</span></code></p>
<p><strong>Example (preferred):</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">MOVD</span> <span class="pre">[foo],</span> <span class="pre">MM0</span></code> <code class="docutils literal notranslate"><span class="pre">PSWAPD</span> <span class="pre">MM0,</span> <span class="pre">MM0</span></code> <code class="docutils literal notranslate"><span class="pre">MOVD</span> <span class="pre">[foo+4],</span> <span class="pre">MM0</span></code> <code class="docutils literal notranslate"><span class="pre">PSWAPD</span> <span class="pre">MM0,</span>
<span class="pre">MM0</span></code> <code class="docutils literal notranslate"><span class="pre">...</span></code> <code class="docutils literal notranslate"><span class="pre">MOV</span> <span class="pre">EAX,</span> <span class="pre">[foo]</span></code> <code class="docutils literal notranslate"><span class="pre">MOV</span> <span class="pre">EDX,</span> <span class="pre">[foo+4]</span></code></p>
<p>Back to <a class="reference internal" href="AssemblerOptimizing.html"><span class="doc">AssemblerOptimizing</span></a></p>
<p>$Date: 2006/11/24 18:21:26 $</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="DataStorageInAviSynth.html" title="DataStorageInAviSynth"
             >next</a> |</li>
        <li class="right" >
          <a href="Cplusplus_api.html" title="C++ API"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2000-2019, AviSynth and AviSynth+ contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>