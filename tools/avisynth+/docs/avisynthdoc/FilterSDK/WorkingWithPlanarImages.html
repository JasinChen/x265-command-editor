

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>WorkingWithPlanarImages &#8212; AviSynth+ 3.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../../_static/AvsiDoc.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="avs2pcm" href="avs2pcm.html" />
    <link rel="prev" title="WorkingWithImages" href="WorkingWithImages.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="avs2pcm.html" title="avs2pcm"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="WorkingWithImages.html" title="WorkingWithImages"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DocIcon-Large.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">WorkingWithPlanarImages</a><ul>
<li><a class="reference internal" href="#see">See:</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="WorkingWithImages.html"
                        title="previous chapter">WorkingWithImages</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="avs2pcm.html"
                        title="next chapter">avs2pcm</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/avisynthdoc/FilterSDK/WorkingWithPlanarImages.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="workingwithplanarimages">
<h1><a class="reference external" href="http://www.avisynth.org/WorkingWithPlanarImages">WorkingWithPlanarImages</a><a class="headerlink" href="#workingwithplanarimages" title="Permalink to this headline">¶</a></h1>
<p>Additional functions have been put in to support planar images. They are the
following:</p>
<p>VideoFrame:</p>
<p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">GetPitch(int</span> <span class="pre">plane)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">GetRowSize(int</span> <span class="pre">plane)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">GetHeight(int</span> <span class="pre">plane)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">VideoFrame*</span> <span class="pre">Subframe(int</span> <span class="pre">rel_offset,</span> <span class="pre">int</span> <span class="pre">new_pitch,</span> <span class="pre">int</span> <span class="pre">new_row_size,</span> <span class="pre">int</span> <span class="pre">new_height,</span> <span class="pre">int</span> <span class="pre">!rel_offsetU,</span> <span class="pre">int</span> <span class="pre">!rel_offsetV,</span> <span class="pre">int</span> <span class="pre">!pitchUV)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">BYTE*</span> <span class="pre">GetReadPtr(int</span> <span class="pre">plane)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">BYTE*</span> <span class="pre">GetWritePtr(int</span> <span class="pre">plane)</span></code></p>
<p>Where plane can be:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">PLANAR_Y</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">PLANAR_U</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">PLANAR_V</span></code></li>
</ul>
<p>PLANAR_Y is equivalent to calling the old functions.</p>
<p>It can be determined whether or not you are dealing with a planar images by
using vi.IsPlanar(). This will return true, if image is planar. Using
vi.RowSize()from VideoInfo only provides you with correct numbers for the
first plane. Use RowSize(int plane) from VideoFrame to obtain the proper
results. The same goes for vi.BytesFromPixels(), which also only returns
correct results for the first plane.</p>
<p>What can be safely assumed for planar images is:</p>
<ul class="simple">
<li>Pitch U = Pitch V.  * RowSize U = RowSize V  * Height U = Height V</li>
</ul>
<p>You should consider the planes as seperate memory regions, and you shouldn’t
begin guessing where “U would be relative to Y”, since it might as well
change.</p>
<p>The general guideline should (as always) be: Use the functions - never
directly access the members of VideoInfo or VideoFrameBuffer or VideoFrame
structs directly, unless you are creating an input source. Always use the
supplied funtions! This is the only way for us to be able to maintain
compatibility with future releases. All processing filters should be able to
use the methods exclusively.</p>
<p>GetRowSize() is special, since it can return mod16 widths for Luma and mod8
aligned widths for chroma planes. When you request the rowsize, you can add
the parameter “PLANAR_Y_ALIGNED” or “PLANAR_U_ALIGNED”/”PLANAR_V_ALIGNED”.
This will give you the width of the image, rounded up to nearest mod16 (or if
already mod16, just rowsize as usual).</p>
<p>This means that you can request an image larger than the actual image,
without risking to write or read into the next line. You can safely do
whatever you like with this data, since AviSynth completely ignores it. This
will enable you to operate on 8 bytes (1 quadword) at the time for all
planes.</p>
<p>Some (producing) filters may want to set a forced pitch. Per default, when
you request a videoframe with a specific modX pitch it might be overruled by
AviSynth. (You do this by using env-&gt;NewVideoFrame(VideoInfo, [alignment]))
In this (very rare case), you can use a negative alignment. This will make
the alignment forced.</p>
<p>If you force an alignment you MUST also apply the AlignPlanar(!PClip) filter
after your own, otherwise your filter will not produce valid output. See
source.cpp for examples.</p>
<div class="section" id="see">
<h2>See:<a class="headerlink" href="#see" title="Permalink to this headline">¶</a></h2>
<p>The example of an AviSynyh <a class="reference internal" href="TwoFiveInvert.html"><span class="doc">TwoFiveInvert</span></a> filter.</p>
<p>Something about the specific <a class="reference internal" href="ColorSpaces.html"><span class="doc">ColorSpaces</span></a>.</p>
<p>More about <a class="reference internal" href="DataStorageInAviSynth.html"><span class="doc">DataStorageInAviSynth</span></a>.</p>
<p>A general introduction to <a class="reference internal" href="WorkingWithImages.html"><span class="doc">WorkingWithImages</span></a>.</p>
<p>Back to <a class="reference internal" href="AviSynthTwoFiveSDK.html"><span class="doc">AviSynthTwoFiveSDK</span></a></p>
<p>$Date: 2006/11/08 20:40:17 $</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="avs2pcm.html" title="avs2pcm"
             >next</a> |</li>
        <li class="right" >
          <a href="WorkingWithImages.html" title="WorkingWithImages"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2000-2019, AviSynth and AviSynth+ contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>