

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>General Purpose To MMX Registers &#8212; AviSynth+ 3.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../../_static/AvsiDoc.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Getting started with audio" href="GettingStartedWithAudio.html" />
    <link rel="prev" title="EnvSaveString" href="EnvSaveString.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="GettingStartedWithAudio.html" title="Getting started with audio"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="EnvSaveString.html" title="EnvSaveString"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DocIcon-Large.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">General Purpose To MMX Registers</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="EnvSaveString.html"
                        title="previous chapter">EnvSaveString</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="GettingStartedWithAudio.html"
                        title="next chapter">Getting started with audio</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/avisynthdoc/FilterSDK/GeneralPurposeToMMXRegisters.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="general-purpose-to-mmx-registers">
<h1>General Purpose To MMX Registers<a class="headerlink" href="#general-purpose-to-mmx-registers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>It might be necessary to move data back and forth between a general purpose
register (EAX for instance) to an MMX register. This can be done by:</p>
<p><code class="docutils literal notranslate"><span class="pre">movd</span> <span class="pre">eax,mm0</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">movd</span> <span class="pre">mm0,eax</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">pinsrw</span> <span class="pre">mm0,eax,0</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">pextrw</span> <span class="pre">eax,mm0,0</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">movmskb</span> <span class="pre">eax,mm0</span></code></p>
<p>These instructions should however <strong>be avoided as much as possible</strong> since
they are executing very slow. It seems like there are severe penalties when
moving data between the MMX registers and the general purpose registers. Most
of these instructions take more than 16 cycles to execute, which is more than
8 times the cyclecount of normal MMX instructions.</p>
<p>In many cases it is actually faster to write the data to a temporary memory
location, using movd, and move the data back into the registry. For much data
it is actually often faster to process the data one line at the time, and
store all data in a temporary space, and process the data in a separate loop.</p>
<hr class="docutils" />
<p><em>phaeron writes:</em></p>
<p>Note that the Microsoft Visual C++ compiler will give you trouble here if you
are using MMX intrinsics, as it is unable to directly generate <code class="docutils literal notranslate"><span class="pre">movd</span>
<span class="pre">mmreg,mem</span></code> and <code class="docutils literal notranslate"><span class="pre">movd</span> <span class="pre">mem,mmreg</span></code> instructions for the <code class="docutils literal notranslate"><span class="pre">_m_to_int()</span></code> and
<code class="docutils literal notranslate"><span class="pre">_m_from_int()</span></code> intrinsics. Instead, the values trampoline off of the
general purpose registers, triggering the undesirable performance behavior
described above. This is true even with the Visual Studio .NET 2003 compiler
(VC7.1), which fixed most of the MMX code generation embarrassments from the
VC6PP and VC7 compilers, most notably MOVQ hell. As such, you’re still better
off sticking with inline or explicit assembly than using MMX intrinsics with
MSVC.</p>
<hr class="docutils" />
<p>Back to <a class="reference internal" href="AssemblerOptimizing.html"><span class="doc">AssemblerOptimizing</span></a></p>
<p>$Date: 2006/11/08 20:40:17 $</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="GettingStartedWithAudio.html" title="Getting started with audio"
             >next</a> |</li>
        <li class="right" >
          <a href="EnvSaveString.html" title="EnvSaveString"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2000-2019, AviSynth and AviSynth+ contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>