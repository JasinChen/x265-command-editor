

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Debugging instructions &#8212; AviSynth+ 3.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../../_static/AvsiDoc.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DualPlugins" href="DualPlugins.html" />
    <link rel="prev" title="DataStorageInAviSynth" href="DataStorageInAviSynth.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="DualPlugins.html" title="DualPlugins"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="DataStorageInAviSynth.html" title="DataStorageInAviSynth"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DocIcon-Large.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Debugging instructions</a><ul>
<li><a class="reference internal" href="#how-to-debug-avisynth">How to debug AviSynth</a></li>
<li><a class="reference internal" href="#how-to-debug-avisynth-plugins">How to debug AviSynth plugins</a><ul>
<li><a class="reference internal" href="#how-to-debug-avisynth-plugins-the-short-way">How to debug AviSynth plugins (the short way)</a></li>
<li><a class="reference internal" href="#how-to-debug-avisynth-plugins-for-ms-vc-6-0">How to debug Avisynth plugins (for MS VC++ 6.0)</a></li>
<li><a class="reference internal" href="#how-to-debug-avisynth-plugins-for-ms-vc-2010">How to debug Avisynth plugins (for MS VC++ 2010)</a></li>
<li><a class="reference internal" href="#how-to-debug-avisynth-console-applications-for-ms-vc-2010">How to debug Avisynth console applications (for MS VC++ 2010)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debug-info-from-map-file">Debug info from MAP file</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="DataStorageInAviSynth.html"
                        title="previous chapter">DataStorageInAviSynth</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="DualPlugins.html"
                        title="next chapter">DualPlugins</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/avisynthdoc/FilterSDK/DebuggingAvisynthPlugins.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="debugging-instructions">
<h1><a class="toc-backref" href="#id1">Debugging instructions</a><a class="headerlink" href="#debugging-instructions" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#debugging-instructions" id="id1">Debugging instructions</a><ul>
<li><a class="reference internal" href="#how-to-debug-avisynth" id="id2">How to debug AviSynth</a></li>
<li><a class="reference internal" href="#how-to-debug-avisynth-plugins" id="id3">How to debug AviSynth plugins</a><ul>
<li><a class="reference internal" href="#how-to-debug-avisynth-plugins-the-short-way" id="id4">How to debug AviSynth plugins (the short way)</a></li>
<li><a class="reference internal" href="#how-to-debug-avisynth-plugins-for-ms-vc-6-0" id="id5">How to debug Avisynth plugins (for MS VC++ 6.0)</a></li>
<li><a class="reference internal" href="#how-to-debug-avisynth-plugins-for-ms-vc-2010" id="id6">How to debug Avisynth plugins (for MS VC++ 2010)</a></li>
<li><a class="reference internal" href="#how-to-debug-avisynth-console-applications-for-ms-vc-2010" id="id7">How to debug Avisynth console applications (for MS VC++ 2010)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debug-info-from-map-file" id="id8">Debug info from MAP file</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="how-to-debug-avisynth">
<h2><a class="toc-backref" href="#id2">How to debug AviSynth</a><a class="headerlink" href="#how-to-debug-avisynth" title="Permalink to this headline">¶</a></h2>
<p>xx</p>
</div>
<div class="section" id="how-to-debug-avisynth-plugins">
<h2><a class="toc-backref" href="#id3">How to debug AviSynth plugins</a><a class="headerlink" href="#how-to-debug-avisynth-plugins" title="Permalink to this headline">¶</a></h2>
<p>Two ways are described to debug your plugin. An easy way using
DebugView and the use of VC++6’s debugger. In both cases, the sample
code <a class="reference internal" href="SimpleSample.html"><span class="doc">SimpleSample</span></a> is used.</p>
<div class="section" id="how-to-debug-avisynth-plugins-the-short-way">
<h3><a class="toc-backref" href="#id4">How to debug AviSynth plugins (the short way)</a><a class="headerlink" href="#how-to-debug-avisynth-plugins-the-short-way" title="Permalink to this headline">¶</a></h3>
<p>An easy way to debug AviSynth plugin is to use a utility called
<a class="reference external" href="http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx">DebugView</a> for Windows which captures OutputDebugString’s output from
your code (OutputDebugString sends a string to your debugger). It’s a
bit limited. So, if this is not sufficient, you should use a debugger
as described in the next section.</p>
<p>1) Open Dbgview.exe. Make sure that ‘Capture Win32’ under the Capture
tab is selected.</p>
<p>2) Add the following line at the start of your code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &lt;stdio.h&gt; /* for using sprintf */</span>
</pre></div>
</div>
<p>Add, for example, the following lines in your code to check whether
certain parameters are passed to the code path which comes after it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">char</span> <span class="n">BUF</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
<span class="n">sprintf</span><span class="p">(</span><span class="n">BUF</span><span class="p">,</span> <span class="s2">&quot;framenr </span><span class="si">%d</span><span class="s2">, text </span><span class="si">%s</span><span class="s2">, height </span><span class="si">%d</span><span class="s2">, pi </span><span class="si">%f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;hey&quot;</span><span class="p">,</span> <span class="n">src_height</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">);</span>
<span class="n">OutputDebugString</span><span class="p">(</span><span class="n">BUF</span><span class="p">);</span>
</pre></div>
</div>
<p>Thus:</p>
<img alt="../../_images/debugging_plugins1a.png" src="../../_images/debugging_plugins1a.png" />
<p>Nb, %d means integer, %s means string and %f means float/double. n
means add a new line.</p>
<div class="line-block">
<div class="line">3) Compile a release build of your plugin.</div>
</div>
<p>4) Open your script and scroll through it. You will see the following
output in DebugView:</p>
<img alt="../../_images/debugging_plugins1b.png" src="../../_images/debugging_plugins1b.png" />
<p>In the example the script is loaded in line 26. After that some
AviSynth output is captured. In the lines 57 and 58 the output of
OutputDebugString is written.</p>
<p>If your script crashes somewhere, you should put these lines just
before the crash (it may take a few attempts to find that point). Then
you should pass the values of the relevant parameters and check whether
they are correct. Apparently there is some parameter whose value is
empty or invalid.</p>
</div>
<div class="section" id="how-to-debug-avisynth-plugins-for-ms-vc-6-0">
<h3><a class="toc-backref" href="#id5">How to debug Avisynth plugins (for MS VC++ 6.0)</a><a class="headerlink" href="#how-to-debug-avisynth-plugins-for-ms-vc-6-0" title="Permalink to this headline">¶</a></h3>
<p>These are the steps to debug an AviSynth plugin in VC++ 6:</p>
<p>1. Go to the build tab and set the Active configuration to the Debug
version of your plugin.</p>
<p>2. Build the debug version of your plugin. Thus go to the build tab and
Build (…).</p>
<p>3. We will use VirtualDub.exe to debug your plugin. Go to Project tab,
then select Settings -&gt; Debug -&gt; General -&gt; Executable for debug
session -&gt; browse to a version of VirtualDub.exe and specify that:</p>
<img alt="../../_images/debugging_plugins2.png" src="../../_images/debugging_plugins2.png" />
<p>4. Go to Project tab, then select Settings -&gt; Debug -&gt; Additional DLLs,
and browse to the filter DLL in the Debug directory:</p>
<img alt="../../_images/debugging_plugins3.png" src="../../_images/debugging_plugins3.png" />
<p>5. Make an AviSynth script that loads and uses your filter. Make sure
to load the Debug version of your plugin! Thus for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LoadPlugin</span><span class="p">(</span><span class="s2">&quot;F:\CompilingPlugins\SimpleSample\Debug\simplesample.dll&quot;</span><span class="p">)</span>
<span class="n">Colorbars</span><span class="p">()</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ConvertTORGB24</span><span class="p">()</span>
<span class="n">SimpleSample</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>6. Set breakpoints as required. You can do this by clicking with the
right mouse button next to a statement in your code (in the grey
section). For example:</p>
<img alt="../../_images/debugging_plugins4.png" src="../../_images/debugging_plugins4.png" />
<p>Select the option: Insert/Remove Breakpoint:</p>
<img alt="../../_images/debugging_plugins5.png" src="../../_images/debugging_plugins5.png" />
<p>7. Go to the Build tab, and select Start Debug -&gt; Go (or the shortcut
F5). VirtualDub will execute. Open the AviSynth script in that
VirtualDub instance. The code will execute up to your first breakpoint
(at least if it follows that code path):</p>
<img alt="../../_images/debugging_plugins6.png" src="../../_images/debugging_plugins6.png" />
<p>You will see a yellow arrow through your breakpoint.</p>
<p>Above I also opened the ‘variables output window’. It is under the View
tab -&gt; Debug Windows -&gt; Variables. You can view the value of the
variables when stepping through your code. Use Debug -&gt; Step Into (or
the shortcut F11) to step through your code. Use Debug -&gt; Step Over (or
the shortcut F10) to step over function calls.</p>
<p>When moving your mouse over a variable, you can also see the value of
it:</p>
<img alt="../../_images/debugging_plugins7.png" src="../../_images/debugging_plugins7.png" />
<p>If you want to set a breakpoint somewhere else, just remove the
existing one (by right clicking on it). Put a new one somewhere and
press F5.</p>
<p>If you want to stop debugging, go to the Debug tab -&gt; Stop Debugging.</p>
</div>
<div class="section" id="how-to-debug-avisynth-plugins-for-ms-vc-2010">
<h3><a class="toc-backref" href="#id6">How to debug Avisynth plugins (for MS VC++ 2010)</a><a class="headerlink" href="#how-to-debug-avisynth-plugins-for-ms-vc-2010" title="Permalink to this headline">¶</a></h3>
<p>Open your project. Select the debug build and build it. Make sure that
you load the debug build in your script.</p>
<p>Open Virtualdub and attach is to the debugger:</p>
<p>Debug &gt; Attach to Process</p>
<img alt="../../_images/Debugging_plugins_msvc2010_001.jpg" src="../../_images/Debugging_plugins_msvc2010_001.jpg" />
<p>Select VirtualDub.exe and press attach:</p>
<img alt="../../_images/Debugging_plugins_msvc2010_002.jpg" src="../../_images/Debugging_plugins_msvc2010_002.jpg" />
<p>Set a breakpoint somewhere. You can do this by clicking with the right
mouse button next to a statement in your code (in the grey section):</p>
<img alt="../../_images/Debugging_plugins_msvc2010_004.jpg" src="../../_images/Debugging_plugins_msvc2010_004.jpg" />
<p>Open the script in Virtualdub and the code will be executed up to point
where you set the breakpoint.</p>
<img alt="../../_images/Debugging_plugins_msvc2010_005.jpg" src="../../_images/Debugging_plugins_msvc2010_005.jpg" />
<p>Instead of attaching Virtualdub to the debugger every time, you can
also do the following:</p>
<p>Right click on the project name (Kuwahara in our case) &gt; Properties &gt;
Configuration Properties &gt; Debug</p>
<p>Enter the location of Virtualdub in the debug command:</p>
<img alt="../../_images/Debugging_plugins_msvc2010_003.jpg" src="../../_images/Debugging_plugins_msvc2010_003.jpg" />
<p>If you set a breakpoint somewhere and start the debugger:</p>
<p>Debug &gt; Start Debugging</p>
<p>It will open Virtualdub and you can open your script to start the
debugging session.</p>
</div>
<div class="section" id="how-to-debug-avisynth-console-applications-for-ms-vc-2010">
<h3><a class="toc-backref" href="#id7">How to debug Avisynth console applications (for MS VC++ 2010)</a><a class="headerlink" href="#how-to-debug-avisynth-console-applications-for-ms-vc-2010" title="Permalink to this headline">¶</a></h3>
<p>Open your project. Select the debug build and build it. Make sure that
you load the debug build in your script.</p>
<p>Right click on the project name (Kuwahara in our case) &gt; Properties &gt;
Configuration Properties &gt; Debug</p>
<p>Enter the location of your console application and its arguments in the
debug command (in our case: avs2yuv.exe example.avs clip.raw):</p>
<img alt="../../_images/Debugging_con_applications_msvc2010_001.jpg" src="../../_images/Debugging_con_applications_msvc2010_001.jpg" />
<img alt="../../_images/Debugging_con_applications_msvc2010_002.jpg" src="../../_images/Debugging_con_applications_msvc2010_002.jpg" />
<p>Set a breakpoint somewhere and start the debugger:</p>
<p>Debug &gt; Start Debugging</p>
<p>It will open the command prompt and start the console application. The
script will be executed to start the debugging session.</p>
</div>
</div>
<div class="section" id="debug-info-from-map-file">
<h2><a class="toc-backref" href="#id8">Debug info from MAP file</a><a class="headerlink" href="#debug-info-from-map-file" title="Permalink to this headline">¶</a></h2>
<p>IanB <a class="reference external" href="http://forum.doom9.org/showthread.php?p=1041578#post1041578">wrote</a>: Recent versions of Avisynth now ship with an
avisynth.map! You can use this accurately get routine addresses.
Avisynth preferably loads at 0x10000000, use the debugger loaded module
display to check this.</p>
<p>Build your plugin in debug mode. If you can, build yourself a Debug or
Relsym avisynth.dll and debug it, if not the use the .map file provided
to interprete the Call stack addresses.</p>
<hr class="docutils" />
<p>Back to <a class="reference internal" href="FilterSDK.html"><span class="doc">AviSynth FilterSDK</span></a></p>
<p>$Date: 2014/10/27 22:04:54 $</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="DualPlugins.html" title="DualPlugins"
             >next</a> |</li>
        <li class="right" >
          <a href="DataStorageInAviSynth.html" title="DataStorageInAviSynth"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2000-2019, AviSynth and AviSynth+ contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>