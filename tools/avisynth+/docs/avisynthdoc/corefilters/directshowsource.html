

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DirectShowSource &#8212; AviSynth+ 3.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../../_static/AvsiDoc.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dissolve" href="dissolve.html" />
    <link rel="prev" title="DeleteFrame" href="deleteframe.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="dissolve.html" title="Dissolve"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="deleteframe.html" title="DeleteFrame"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/DocIcon-Large.svg" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">DirectShowSource</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#troubleshooting-video-and-audio-problems">Troubleshooting video and audio problems</a><ul>
<li><a class="reference internal" href="#renderfile-the-filter-graph-manager-won-t-talk-to-me">RenderFile, the filter graph manager won’t talk to me</a></li>
<li><a class="reference internal" href="#the-samplerate-is-wrong">The samplerate is wrong</a></li>
<li><a class="reference internal" href="#my-sound-is-choppy">My sound is choppy</a></li>
<li><a class="reference internal" href="#my-sound-is-out-of-sync">My sound is out of sync</a></li>
<li><a class="reference internal" href="#my-asf-renders-start-fast-and-finish-slow">My ASF renders start fast and finish slow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#common-tasks">Common tasks</a><ul>
<li><a class="reference internal" href="#opening-grf-files">Opening GRF files</a></li>
<li><a class="reference internal" href="#downmixing-ac3-to-stereo">Downmixing AC3 to stereo</a></li>
</ul>
</li>
<li><a class="reference internal" href="#windows-7-users">Windows 7 users</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="deleteframe.html"
                        title="previous chapter">DeleteFrame</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dissolve.html"
                        title="next chapter">Dissolve</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/avisynthdoc/corefilters/directshowsource.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="directshowsource">
<h1>DirectShowSource<a class="headerlink" href="#directshowsource" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">DirectShowSource</span></code> (string filename, float “fps”, bool “seek”, bool
“audio”, bool “video”, bool “convertfps”, bool “seekzero”, int “timeout”,
string “pixel_type”, int “framecount”, string “logfile”, int “logmask”)</p>
<p><code class="docutils literal notranslate"><span class="pre">DirectShowSource</span></code> reads the file <em>filename</em> using DirectShow, the same
multimedia playback system which Windows Media Player uses. It can read most
formats which Media Player can play, including MPEG, MP3, and QuickTime, as
well as AVI files that <code class="docutils literal notranslate"><span class="pre">AVISource</span></code> doesn’t support (like DV type 1, or
files using DirectShow-only codecs). Try reading AVI files with <code class="docutils literal notranslate"><span class="pre">AVISource</span></code>
first, and if that doesn’t work then try this filter instead.</p>
<p>There are some caveats:</p>
<ul class="simple">
<li>Some decoders (notably MS MPEG-4) will produce upside-down video.
You’ll have to use <a class="reference internal" href="flip.html"><span class="doc">FlipVertical</span></a>.</li>
<li>DirectShow video decoders are not required to support frame-accurate
seeking. In most cases seeking will work, but on some it might not.</li>
<li>DirectShow video decoders are not even required to tell you the frame
rate of the incoming video. Most do, but the ASF decoder doesn’t. You
have to specify the frame rate using the fps parameter, like this:
<code class="docutils literal notranslate"><span class="pre">DirectShowSource</span></code> (“video.asf”, fps=15).</li>
<li>This version automatically detects the Microsoft DV codec and sets it
to decode at full (instead of half) resolution. I guess this isn’t a
caveat. :-)</li>
<li>Also this version attempts to disable any decoder based
deinterlacing.</li>
</ul>
<p><em>fps</em>: This is sometimes needed to specify the framerate of the video. If the
framerate or the number of frames is incorrect (this can happen with asf or
mov clips), use this option to force the correct framerate.</p>
<p><em>seek</em> = true (in <em>v2.53</em>): There is full seeking support (available on most
file formats). If problems occur try enabling the seekzero option first, if
seeking still cause problems completely disable seeking. With seeking
disabled the audio stream returns silence and the video stream the last
rendered frame when trying to seek backwards. Note the AviSynth cache may
provide limited access to the previous few frames, beyond that the last frame
rendered will be returned.</p>
<p><em>audio</em> = true (in <em>v2.53</em>): There is audio support in DirectShowSource.
DirectShowSource is able to open formats like WAV/DTS/AC3/MP3, provided you
can play them in WMP for example (more exact: provided they are rendered
correctly in graphedit). The channel ordering is the same as in the
[<a class="reference external" href="http://www.cs.bath.ac.uk/~jpff/NOS-DREAM/researchdev/wave-ex/wave_ex.html">wave-format-extensible format</a>], because the input is always decompressed to WAV.
For more information, see also GetChannel. AviSynth loads 8, 16, 24 and 32
bit int PCM samples, and float PCM format, and any number of channels.</p>
<p><em>video</em> = true (in <em>v2.52</em>): When setting it to false, it lets you open the
audio only.</p>
<p><em>convertfps</em> = false (in <em>v2.56</em>): When setting it to true, it turns variable
framerate video (vfr) into constant framerate video (cfr) by duplicating or
skipping frames. This is useful when you want to open vfr video (for example
mkv, rmvb, mp4, asf or wmv with hybrid video) in AviSynth. It is most useful
when the fps parameter is set to the least common multiple of the component
vfr rates, e.g. 120 or 119.880.</p>
<p><em>seekzero</em> = false (in <em>v2.56</em>): An option to restrict seeking only back to the
beginning. It allows limited seeking with files like unindexed ASF. Seeking
forwards is of course done the hard way (by reading all samples).</p>
<p><em>timeout</em> = 60000 (in milliseconds; 60000 ms = 1 min) (in <em>v2.56</em>): To set time
to wait when DirectShow refuses to render. Positive values cause the return
of blank frames for video and silence for audio streams. Negative values
cause a runtime Avisynth exception to be thrown.</p>
<p><em>pixel_type</em> (in <em>v2.56</em>): The mnemonic for the videomedia subtype negotiated
for the IPin connection. It can be “YV24”, “YV16”, “YV12”, “YUY2”, “AYUV”,
“Y41P”, “Y411”, “ARGB”, “RGB32”, “RGB24”, “YUV”, “YUVex”, “RGB”, “AUTO” or
“FULL”. By default, upstream DirectShow filters are free to bid all of their
supported media types in the order of their choice. A few DirectShow filters
get this wrong. The <strong>pixel_type</strong> argument limits the acceptable video
stream subformats for the IPin negotiation. Note the graph builder may add a
format converter to satisfy your request, so make sure the codec in use can
actually decode to your chosen format. The M$ format converter is just
adequate. The “YUV” and “RGB” pseudo-types restrict the negotiation to all
official supported YUV or RGB formats respectively. The “YUVex” also includes
YV24 and YV16 non-standard pixel types. The “AUTO” pseudo-type permits the
negotiation to use all relevant official formats, YUV plus RGB. The “FULL”
pseudo-type includes the YV24 and YV16 non-standard pixel types in addition
to those supported by “AUTO”. The full order of preference is YV24, YV16,
YV12, YUY2, AYUV, Y41P, Y411, ARGB, RGB32, RGB24. Many DirectShow filters get
this wrong, which is why it is not enabled by default. The option exists so
you have enough control to encourage the maximum range of filters to serve
your media. (See <a class="reference external" href="http://forum.doom9.org/showthread.php?t=143321">discussion</a>.)</p>
<div class="line-block">
<div class="line">The two non-standard pixel types, YV24 and YV16 use the following GUID’s
respectivly :-</div>
<div class="line">MEDIASUBTYPE_YV24 = {‘42VY’, 0x0000, 0x0010, 0x80, 0x00, 0x00, 0xaa, 0x00,
0x38, 0x9b, 0x71};</div>
<div class="line">MEDIASUBTYPE_YV16 = {‘61VY’, 0x0000, 0x0010, 0x80, 0x00, 0x00, 0xaa, 0x00,
0x38, 0x9b, 0x71};</div>
</div>
<p><em>framecount</em> (in <em>v2.57</em>): This is sometimes needed to specify the framecount
of the video. If the framerate or the number of frames is incorrect (this can
happen with asf or mov clips), use this option to force the correct number of
frames. If fps is also specified the length of the audio stream is also
adjusted.</p>
<p><em>logfile</em> (in <em>v2.57</em>): Use this option to specify the name of a debugging
logfile.</p>
<p><em>logmask</em> = 35 (in <em>v2.57</em>): When a logfile is specified, use this option to
select which information is logged.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Data</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Format Negotiation</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>Receive samples</td>
</tr>
<tr class="row-even"><td>4</td>
<td>GetFrame/GetAudio calls</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>Directshow callbacks</td>
</tr>
<tr class="row-even"><td>16</td>
<td>Requests to Directshow</td>
</tr>
<tr class="row-odd"><td>32</td>
<td>Errors</td>
</tr>
<tr class="row-even"><td>64</td>
<td>COM object use count</td>
</tr>
<tr class="row-odd"><td>128</td>
<td>New objects</td>
</tr>
<tr class="row-even"><td>256</td>
<td>Extra info</td>
</tr>
<tr class="row-odd"><td>512</td>
<td>Wait events</td>
</tr>
</tbody>
</table>
<p>Add the values together of the data you need logged. Specify -1 to log
everything. The default, 35, logs Format Negotiation, Received samples and
Errors. i.e 1+2+32</p>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Opens an avi with the first available RGB format (without audio):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;F:\TestStreams\xvid.avi&quot;</span><span class="p">,</span>
\       <span class="n">fps</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">audio</span><span class="o">=</span><span class="n">false</span><span class="p">,</span> <span class="n">pixel_type</span><span class="o">=</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Opens a DV clip with the MS DV decoder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;F:\DVCodecs\Analysis\Ced_dv.avi&quot;</span><span class="p">)</span> <span class="c1"># MS-DV</span>
</pre></div>
</div>
<p>Opens a variable framerate mkv as 119.88 by adding frames (ensuring sync):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;F:\Guides\Hybrid</span><span class="se">\v</span><span class="s2">fr_startrek.mkv&quot;</span><span class="p">,</span>
\       <span class="n">fps</span><span class="o">=</span><span class="mf">119.88</span><span class="p">,</span> <span class="n">convertfps</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
<p>Opens a realmedia (<code class="docutils literal notranslate"><span class="pre">*.rmvb</span></code>) clip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;F:</span><span class="se">\t</span><span class="s2">est.rmvb&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">convertfps</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
<p>Opens a GraphEdit file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="o">=</span><span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;F:</span><span class="se">\v</span><span class="s2">id_graph.grf&quot;</span><span class="p">,</span> <span class="n">audio</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># video only (audio renderer removed)</span>
<span class="n">A</span><span class="o">=</span><span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;F:</span><span class="se">\a</span><span class="s2">ud_graph.grf&quot;</span><span class="p">,</span> <span class="n">video</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># audio only</span>
<span class="p">(</span><span class="n">video</span> <span class="n">renderer</span> <span class="n">removed</span><span class="p">)</span>
<span class="n">AudioDub</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<p>See below for some audio examples.</p>
</div>
<div class="section" id="troubleshooting-video-and-audio-problems">
<h2>Troubleshooting video and audio problems<a class="headerlink" href="#troubleshooting-video-and-audio-problems" title="Permalink to this headline">¶</a></h2>
<p>AviSynth will by default try to open only the media it can open without any
problems. If one component cannot be opened it will simply not be added to
the output. This will also mean that if there is a problem, you will not see
the error. To get the error message to the missing component, use audio=false
or video=false and disable the component that is actually working. This way
AviSynth will print out the error message of the component that doesn’t work.</p>
<div class="section" id="renderfile-the-filter-graph-manager-won-t-talk-to-me">
<h3>RenderFile, the filter graph manager won’t talk to me<a class="headerlink" href="#renderfile-the-filter-graph-manager-won-t-talk-to-me" title="Permalink to this headline">¶</a></h3>
<p>This is a common error that occurs when DirectShow isn’t able to deliver any
format that is readable to AviSynth. Try creating a filter graph manually and
see if you are able to construct a filter graph that delivers any output
AviSynth can open. If not, you might need to download additional DirectShow
filters that can deliver correct material.</p>
</div>
<div class="section" id="the-samplerate-is-wrong">
<h3>The samplerate is wrong<a class="headerlink" href="#the-samplerate-is-wrong" title="Permalink to this headline">¶</a></h3>
<p>Some filters might have problems reporting the right samplerate, and then
correct this when the file is actually playing. Unfortunately there is no way
for AviSynth to correct this once the file has been opened. Use
<a class="reference internal" href="assumerate.html"><span class="doc">AssumeSampleRate</span></a> and set the correct samplerate to fix this problem.</p>
</div>
<div class="section" id="my-sound-is-choppy">
<h3>My sound is choppy<a class="headerlink" href="#my-sound-is-choppy" title="Permalink to this headline">¶</a></h3>
<p>Unfortunately Directshow is not required to support sample exact seeking.
Open the sound another way, or demux your video file and serve it to AviSynth
another way. Otherwise you can specify “seekzero = true” or “seek = false” as
parameters or use the <a class="reference internal" href="ensuresync.html"><span class="doc">EnsureVBRMP3Sync</span></a> filter to enforce linear access to
the Directshow audio stream.</p>
</div>
<div class="section" id="my-sound-is-out-of-sync">
<h3>My sound is out of sync<a class="headerlink" href="#my-sound-is-out-of-sync" title="Permalink to this headline">¶</a></h3>
<p>This can happen especially with WMV, apparently due to variable frame rate
video being returned. Determine what the fps should be and set it explicitly,
and also “ConvertFPS” to force it to remain constant. And <a class="reference internal" href="ensuresync.html"><span class="doc">EnsureVBRMP3Sync</span></a>
reduces problems with variable rate audio.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;video.wmv&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">ConvertFPS</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">EnsureVBRMP3Sync</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="my-asf-renders-start-fast-and-finish-slow">
<h3>My ASF renders start fast and finish slow<a class="headerlink" href="#my-asf-renders-start-fast-and-finish-slow" title="Permalink to this headline">¶</a></h3>
<p>Microsoft in their infinite wisdom chose to implement ASF stream timing in
the ASF demuxer. As a result it is not possible to strip ASF format files any
faster than realtime. This is most apparent when you first start to process
the streams, usually after opening the Avisynth script it takes you a while
to configure your video editor, all this time the muxer is accumulating
<em>credit</em> time. When you then start to process your stream it races away at
maximum speed until you catch up to realtime at which point it slows down to
the realtime rate of the source material. This feature makes it impossible to
use Avisynth to reclock 24fps ASF material upto 25fps for direct PAL
playback.</p>
</div>
</div>
<div class="section" id="common-tasks">
<h2>Common tasks<a class="headerlink" href="#common-tasks" title="Permalink to this headline">¶</a></h2>
<p>This section will describe various tasks that might not be 100% obvious. :)</p>
<div class="section" id="opening-grf-files">
<h3>Opening GRF files<a class="headerlink" href="#opening-grf-files" title="Permalink to this headline">¶</a></h3>
<p>GraphEdit GRF-files are automatically detected by a .grf filename extension
and directly loaded by DirectShowSource. For AviSynth to be able to connect
to it, you must leave a pin open in GraphEdit of a media types that AviSynth
is able to connect to. AviSynth will not attempt to disconnect any filters,
so it is important that the output type is correct. DirectShowSource only
accepts YV24, YV16, YV12, YUY2, AYUV, Y41P, Y411, ARGB, RGB32 and RGB24 video
formats and 32, 24, 16 and 8 bit PCM and IEEE FLOAT audio formats.</p>
<p>A given GRF-file should only target one of an audio or video stream to avoid
confusion when directshowsource attempts the connection to your open pin(s).
From version 2.57 this single stream restriction is enforced.</p>
</div>
<div class="section" id="downmixing-ac3-to-stereo">
<h3>Downmixing AC3 to stereo<a class="headerlink" href="#downmixing-ac3-to-stereo" title="Permalink to this headline">¶</a></h3>
<p>There are essentially two ways to do this. The first is to set the downmixing
in the configuration of your AC3 decoder itself, and the second one is to use
the external downmixer of “Trombettworks”:</p>
<ol class="arabic simple">
<li>Install AC3filter.</li>
</ol>
<p>a) Open <strong>AC3Filter Config</strong>
On tab “Main” in section “Output format” select “2/0 - stereo”.
[Nothing else is needed.]</p>
<p><strong>*-OR-*</strong></p>
<p>b) Open the AC3 file in WMP6.4 and select the file properties. Set the output
of AC3Filter on <strong>2/0 - stereo</strong>. If you want the best possible quality,
select PCM Float as Sample format.</p>
<img alt="../../_images/ac3downmix1a.jpg" src="../../_images/ac3downmix1a.jpg" />
<img alt="../../_images/ac3downmix1b.jpg" src="../../_images/ac3downmix1b.jpg" />
<p>Make the following script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">Mpeg2Source</span><span class="p">(</span><span class="s2">&quot;e:\movie.d2v&quot;</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;e:\Temp\Test2</span><span class="se">\t</span><span class="s2">est.ac3&quot;</span><span class="p">)</span>
<span class="n">AudioDub</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, open the script in vdub and convert the audio stream to MP3
(of course you can also demux the downmixed WAV stream if needed).</p>
<ol class="arabic" start="2">
<li><p class="first">Register the directshow filter <a class="reference external" href="http://www.trombettworks.com/directshow.php">Channel Downmixer by Trombettworks</a>
(under start -&gt; run):</p>
<blockquote>
<div><p><em>regsvr32 ChannelDownmixer.ax</em></p>
</div></blockquote>
</li>
</ol>
<p>Open the AC3 file in WMP6.4 and select the file properties. Set the output of
AC3Filter on <strong>3/2+SW 5.1 channels</strong> (this downmixer can’t handle PCM Float,
thus PCM 16 bit is selected here). In the properties of the downmixer, the
number of input and output channels should be detected automatically. Check
whether this is indeed correct.</p>
<img alt="../../_images/ac3downmix2a.jpg" src="../../_images/ac3downmix2a.jpg" />
<img alt="../../_images/ac3downmix2b.jpg" src="../../_images/ac3downmix2b.jpg" />
<img alt="../../_images/ac3downmix2c.jpg" src="../../_images/ac3downmix2c.jpg" />
<p>Make the following script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">Mpeg2Source</span><span class="p">(</span><span class="s2">&quot;e:\movie.d2v&quot;</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">DirectShowSource</span><span class="p">(</span><span class="s2">&quot;e:\Temp\Test2</span><span class="se">\t</span><span class="s2">est.ac3&quot;</span><span class="p">)</span>
<span class="n">AudioDub</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, open the script in vdub and convert the audio stream to MP3
(of course you can also demux the downmixed WAV stream if needed).</p>
<p>For some reason, I can’t get this to work with DTS streams :(</p>
</div>
</div>
<div class="section" id="windows-7-users">
<h2>Windows 7 users<a class="headerlink" href="#windows-7-users" title="Permalink to this headline">¶</a></h2>
<p>Windows 7 forces its own DirectShow filters for decoding several audio and
video formats. Changing their merits or physically removing those filters
doesn’t help. clsid made the tool “<a class="reference external" href="http://forum.doom9.org/showthread.php?t=146910">Win7DSFilterTweaker</a>” to change the
preferred filters. However new decoders need to be added each time so it’s
not the perfect solution.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Changes</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>v2.60</td>
<td>Added pixel_types “YV24”, “YV16”, “AYUV”, “Y41P”, “Y411”.</td>
</tr>
<tr class="row-odd"><td>v2.57</td>
<td><div class="first last line-block">
<div class="line">framecount overrides the length of the streams.</div>
<div class="line">logfile and logmask specify debug logging.</div>
</div>
</td>
</tr>
<tr class="row-even"><td>v2.56</td>
<td><div class="first last line-block">
<div class="line">convertfps turns vfr into constant cfr by adding frames</div>
<div class="line">seekzero restricts seeking to begining only</div>
<div class="line">timeout controls response to recalcitrant graphs</div>
<div class="line">pixel_type specifies/restricts output video pixel format</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>$Date: 2013/01/25 02:45:53 $</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="dissolve.html" title="Dissolve"
             >next</a> |</li>
        <li class="right" >
          <a href="deleteframe.html" title="DeleteFrame"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">AviSynth+ 3.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Invisible Tree</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2000-2019, AviSynth and AviSynth+ contributors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>